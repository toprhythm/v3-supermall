#  é¡¹ç›®èµ·æ­¥

> ç›®çš„ï¼šä½¿ç”¨vue-cliåˆ›å»ºä¸€ä¸ªvue3.0é¡¹ç›®ã€‚
>
> è€å¸ˆç¬¬ä¸€å¤©æ–‡æ¡£: https://zhoushugang.gitee.io/erabbit-client-pc-document/guide/02-started.html



## typoraæ ·å¼ä»£ç å—ç¾åŒ–

> typora åå¥½è®¾ç½®->å¤–è§‚->æ‰“å¼€ä¸»é¢˜æ–‡ä»¶å¤¹->æ‰¾åˆ°å½“å‰ä¸»é¢˜çš„æ–‡ä»¶å¤¹ã€‚åˆ›å»ºä¸€ä¸ªdracula.css,é‡å¯typoraï¼Œç‚¹å‡»ä¸»é¢˜ï¼Œé€‰ä¸­Dracula

```css
/*

    Name:       dracula
    Author:     Michael Kaminsky (http://github.com/mkaminsky11)

    Original dracula color scheme by Zeno Rocha (https://github.com/zenorocha/dracula-theme)

*/

/* æ ‡ç­¾é¢œè‰²ä¿®æ”¹ï¼Œåœ¨typoraé‡Œæ˜¯ `å†…å®¹` */
code {
  background-color: #f8f8f8;
  padding: 0 2px;
  color: #48b885;
}
/* æ ‡ç­¾é¢œè‰²ä¿®æ”¹ï¼Œåœ¨typoraé‡Œæ˜¯ `å†…å®¹` */


blockquote {
  /* border-left: 4px solid #dfe2e5; */
  /* padding: 0 15px; */
  /* color: #777777; */
  /* yunzoumidifyed */
  border-left: 6px solid #ff8888;
  padding: 20px 15px;
  background-color: #f3f5f7;
  color: #2d3f50;
  /* yunzoumidifyed */
}

/* yunzoumidifyed */
.cm-s-inner .CodeMirror-cursor {
  border-left: 4px solid #e8705e !important;
}
/* yunzoumidifyed */

.cm-s-inner.CodeMirror, .cm-s-inner .CodeMirror-gutters {
  background-color: #282a36 !important;
  color: #f8f8f2 !important;
  border: none;
  /* yunzoumodifyed */
  padding: 20px 0;
  /* yunzoumodifyed */
}
.cm-s-inner .CodeMirror-gutters { color: #282a36; }
.cm-s-inner .CodeMirror-cursor { border-left: solid thin #f8f8f0; }
.cm-s-inner .CodeMirror-linenumber { color: #6D8A88; }
.cm-s-inner .CodeMirror-selected { background: rgba(255, 255, 255, 0.10); }
.cm-s-inner .CodeMirror-line::selection, .cm-s-inner .CodeMirror-line > span::selection, .cm-s-inner .CodeMirror-line > span > span::selection { background: rgba(255, 255, 255, 0.10); }
.cm-s-inner .CodeMirror-line::-moz-selection, .cm-s-inner .CodeMirror-line > span::-moz-selection, .cm-s-inner .CodeMirror-line > span > span::-moz-selection { background: rgba(255, 255, 255, 0.10); }
/* yunzoumodifyed */
.cm-s-inner span.cm-comment { color: #027AFF; }
/* yunzoumodifyed */
.cm-s-inner span.cm-string, .cm-s-inner span.cm-string-2 { color: #f1fa8c; }
.cm-s-inner span.cm-number { color: #bd93f9; }
.cm-s-inner span.cm-variable { color: #50fa7b; }
.cm-s-inner span.cm-variable-2 { color: white; }
.cm-s-inner span.cm-def { color: #50fa7b; }
.cm-s-inner span.cm-operator { color: #ff79c6; }
.cm-s-inner span.cm-keyword { color: #ff79c6; }
.cm-s-inner span.cm-atom { color: #bd93f9; }
.cm-s-inner span.cm-meta { color: #f8f8f2; }
.cm-s-inner span.cm-tag { color: #ff79c6; }
.cm-s-inner span.cm-attribute { color: #50fa7b; }
.cm-s-inner span.cm-qualifier { color: #50fa7b; }
.cm-s-inner span.cm-property { color: #66d9ef; }
.cm-s-inner span.cm-builtin { color: #50fa7b; }
.cm-s-inner span.cm-variable-3, .cm-s-inner span.cm-type { color: #ffb86c; }

.cm-s-inner .CodeMirror-activeline-background { background: rgba(255,255,255,0.1); }
.cm-s-inner .CodeMirror-matchingbracket { text-decoration: underline; color: white !important; }
```

> Typoraç¾åŒ–æ•ˆæœå›¾

![image-20211208133801560](https://gitee.com/toprhythm/imagebed/raw/master/picgoimagebebrepo/image-20211208133801560.png)

##  01-åˆ›å»ºé¡¹ç›®

ç¬¬ä¸€æ­¥ï¼šæ‰“å¼€å‘½ä»¤è¡Œçª—å£ã€‚

```shell
cd ~/Desktop/codebase/toprhythm_front_code/front_pro_code/
```

- æ³¨æ„ï¼Œæ‰€åœ¨ç›®å½•å°†ä¼šæ˜¯ä½ åˆ›å»ºé¡¹ç›®çš„ç›®å½•ã€‚

ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œåˆ›å»ºé¡¹ç›®å‘½ä»¤è¡Œ

```js
âœ  front_pro_code: vue create yunzoumall-pc-vue3-pro
```

ç¬¬ä¸‰æ­¥ï¼šé€‰æ‹©è‡ªå®šä¹‰åˆ›å»º

```js
? Please pick a preset:
  n ([Vue 3] node-sass, babel, router, vuex, eslint)
  Default ([Vue 2] babel, eslint)
  Default (Vue 3) ([Vue 3] babel, eslint)
â¯ Manually select features
```

ç¬¬å››æ­¥ï¼šé€‰ä¸­ <font size=5 color='red'>vue-router,vuex,css Pre-processors</font> é€‰é¡¹, æŒ‰ç©ºæ ¼é€‰ä¸­ä¸€ä¸ªé€‰é¡¹,äºŒæ¬¡æŒ‰ç©ºæ ¼å–æ¶ˆ

```js
? Please pick a preset: Manually select features
? Check the features needed for your project:
 â—‰ Choose Vue version
 â—‰ Babel
 â—¯ TypeScript
 â—¯ Progressive Web App (PWA) Support
 â—‰ Router
 â—‰ Vuex
â¯â—‰ CSS Pre-processors
 â—‰ Linter / Formatter
 â—¯ Unit Testing
 â—¯ E2E Testing
```

ç¬¬äº”æ­¥ï¼šé€‰æ‹©vue3.0ç‰ˆæœ¬

```js
? Choose a version of Vue.js that you want to start the project with
  2.x
â¯ 3.x
```

ç¬¬å…­æ­¥ï¼šé€‰æ‹©hashæ¨¡å¼çš„è·¯ç”±

```js
? Use history mode for router? (Requires proper server setup for index fallback
in production) (Y/n) n
```

ç¬¬ä¸ƒæ­¥ï¼šé€‰æ‹©lessä½œä¸ºé¢„å¤„ç†å™¨

```js
? Pick a CSS pre-processor (PostCSS, Autoprefixer and CSS Modules are supported
by default):
  Sass/SCSS (with dart-sass)
  Sass/SCSS (with node-sass)
â¯ Less
  Stylus
```

ç¬¬å…«æ­¥ï¼šé€‰æ‹© standard æ ‡å‡†ä»£ç é£æ ¼

```js
? Pick a linter / formatter config:
  ESLint with error prevention only
  ESLint + Airbnb config
â¯ ESLint + Standard config
  ESLint + Prettier
```

ç¬¬ä¹æ­¥ï¼šä¿å­˜ä»£ç æ ¡éªŒä»£ç é£æ ¼ï¼Œä»£ç æäº¤æ—¶å€™æ ¡éªŒä»£ç é£æ ¼

```js
? Pick additional lint features:
 â—‰ Lint on save
â¯â—‰ Lint and fix on commit
```

ç¬¬åæ­¥ï¼šä¾èµ–æ’ä»¶æˆ–è€…å·¥å…·çš„é…ç½®æ–‡ä»¶åˆ†æ–‡ä»¶ä¿å­˜

```js
? Where do you prefer placing config for Babel, ESLint, etc.? (Use arrow keys)
â¯ In dedicated config files
  In package.json
```

ç¬¬åä¸€æ­¥ï¼šæ˜¯å¦è®°å½•ä»¥ä¸Šæ“ä½œä¿å­˜ä¸ºä¸€ä¸ªé¢„è®¾å¹¶ä¸”ä¸ºé¢„è®¾å‘½åï¼Œé€‰æ‹©å¦

```js
? Save this as a preset for future projects? (y/N) n
```

ç¬¬åäºŒæ­¥ï¼šç­‰å¾…å®‰è£…...

```js
Vue CLI v4.5.13
âœ¨  Creating project in /Users/mac/Desktop/codebase/toprhythm_front_code/front_pro_code/yunzoumall-pc-vue3-pro.
ğŸ—ƒ  Initializing git repository...
âš™ï¸  Installing CLI plugins. This might take a while...

â¸¨ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â¸© â ™ fetchMetadata: sill pacote range manifest for unicode-ma......
```

ç¬¬åä¸‰æ­¥ï¼šå®‰è£…å®Œæ¯•

```js
ğŸ‰  Successfully created project yunzoumall-pc-vue3-pro.
ğŸ‘‰  Get started with the following commands:

 $ cd yunzoumall-pc-vue3-pro
 $ npm run serve
```

ç¬¬åå››æ­¥ï¼šè¿›å…¥ç”Ÿæˆå¥½çš„é¡¹ç›®

```js
cd yunzoumall-pc-vue3-pro
```

æœ€åä¸€æ­¥ï¼šæŠŠvue3é¡¹ç›®è·‘èµ·æ¥

```js
npm run serve
```

http://localhost:8080/#/



##  02-ç›®å½•è°ƒæ•´

> ç›®çš„ï¼šå¯¹é¡¹ç›®åŠŸèƒ½æ¨¡å—è¿›è¡Œæ‹†åˆ†ã€‚

å¤§è‡´æ­¥éª¤ï¼š

- åˆ é™¤æ— ç”¨ä»£ç å’Œæ–‡ä»¶
- å®Œå–„é¡¹ç›®çš„åŸºç¡€ç»“æ„
- è¯»æ‡‚é»˜è®¤ç”Ÿæˆçš„ä»£ç 

å®Œå–„é¡¹ç›®ç»“æ„æ­¥éª¤:

ç¬¬ä¸€æ­¥ï¼šåˆ é™¤logo.png

ç¬¬äºŒæ­¥ï¼šæ¸…ç©ºrouter/index.jsé‡Œçš„routesæ•°ç»„å˜é‡,åˆ é™¤Home.vueçš„å¯¼å…¥

```js
import { createRouter, createWebHashHistory } from 'vue-router'

// è·¯ç”±è§„åˆ™
const routes = []

// vue2.0 new VueRouter({}) åˆ›å»ºè·¯ç”±å®ä¾‹
// vue3.0 createRouter({})  åˆ›å»ºè·¯ç”±å®ä¾‹
const router = createRouter({
  // ä½¿ç”¨hashçš„è·¯ç”±æ¨¡å¼("localhost:8080/#/")
  history: createWebHashHistory(),
  routes
})

export default router

```

ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹store/index.js

```js
import { createStore } from 'vuex'

// vue2.0 åˆ›å»ºä»“åº“ new Vuex.Store({})
// vue3.0 åˆ›å»ºä»“åº“ createStore({})
export default createStore({
  state: {
  },
  // è¡¥ä¸Šä¸€ä¸ªç¼ºå¤±çš„getters
  getters: {

  },
  mutations: {
  },
  actions: {
  },
  modules: {
  }
})

```

ç¬¬å››æ­¥ï¼šåˆ é™¤viewä¸‹çš„Home.vueå’ŒAbout.vue

ç¬¬äº”æ­¥ï¼šæ¸…ç©ºApp.vueåªå‰©ä¸‹æ¨¡æ¿å±‚ä»£ç ,æ‰“å¼€f12ï¼ŒæŸ¥çœ‹å‰ç«¯å±•ç¤ºæ•ˆæœ

```vue
<template>
  <!-- vue2.0éœ€è¦æ ¹ç»„ä»¶ï¼Œvue3.0å¯ä»¥æ˜¯ä»£ç ç‰‡æ®µï¼Œæ ¹ç»„ä»¶å¯æœ‰å¯æ—  -->
  <div>
    æ ¹ç»„ä»¶123
  </div>
  <p>ä¸€æ®µæ–‡å­—..</p>
</template>

```

ç¬¬å…­æ­¥ï¼šè§£è¯»ä¸€ä¸‹main.js

```js
import { createApp } from 'vue'
import App from './App.vue'
import router from './router'
import store from './store'

// åˆ›å»ºä¸€ä¸ªvueåº”ç”¨å®ä¾‹ä½¿ç”¨çŠ¶æ€ç®¡ç†åŠ ä¸Šè·¯ç”±å¹¶ä¸”æŒ‚è½½åˆ°idä¸ºappçš„å®¹å™¨ä¸Š
createApp(App).use(store).use(router).mount('#app')

```

ç¬¬ä¸ƒæ­¥ï¼šå®Œå–„é¡¹ç›®ç»“æ„

- â‘ srcä¸‹åˆ›å»ºapiæ–‡ä»¶å¤¹
- â‘¡assetsä¸‹åˆ›å»ºimagesæ–‡ä»¶å¤¹
- â‘¢assetsä¸‹åˆ›å»ºstylesæ–‡ä»¶å¤¹
- â‘£srcä¸‹åˆ›å»ºvonderæ–‡ä»¶å¤¹
- â‘¤srcä¸‹åˆ›å»ºutilsæ–‡ä»¶å¤¹
- â‘¥viewsä¸‹åˆ›å»ºLayout.vueæ–‡ä»¶
- â‘¦viewsä¸‹åˆ›å»ºhomeæ–‡ä»¶å¤¹
- â‘§viewsä¸‹åˆ›å»ºcategoryæ–‡ä»¶å¤¹
- â‘¨viewsä¸‹åˆ›å»ºgoodsæ–‡ä»¶å¤¹
- â‘©viewsä¸‹åˆ›å»ºcartæ–‡ä»¶å¤¹
- 11ã€viewsä¸‹åˆ›å»ºmemberæ–‡ä»¶å¤¹
- 12ã€memberä¸‹åˆ›å»ºpayæ–‡ä»¶å¤¹
- 13ã€memberä¸‹åˆ›å»ºhomeæ–‡ä»¶å¤¹
- 14ã€memberä¸‹åˆ›å»ºorderæ–‡ä»¶å¤¹
- 15ã€åˆ é™¤components/HelloWorld.vueæ–‡ä»¶



è½åœ°å›¾å‚è€ƒ:

![image-20211208142454850](https://gitee.com/toprhythm/imagebed/raw/master/picgoimagebebrepo/image-20211208142454850.png)



**é¢å¤–å¢åŠ ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼š**

- `jsconfig.json`

```js
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"],
    }
  },
  "exclude": ["node_modules", "dist"]
}
```

å½“æˆ‘ä»¬vscodeä½¿ç”¨è·¯å¾„åˆ«å@çš„æ—¶å€™å¯ä»¥è‡ªåŠ¨æç¤ºè¡¥å…¨è·¯å¾„ã€‚

- `.eslintignore`

```js
/dist
/src/vonder
```

eslintåœ¨åšé£æ ¼æ£€æŸ¥çš„æ—¶å€™å¿½ç•¥ dist å’Œ vender ä¸å»æ£€æŸ¥ã€‚



## 03-vuex-åŸºç¡€

> ç›®çš„ï¼šçŸ¥é“æ¯ä¸ªé…ç½®ä½œç”¨ï¼Œæ ¹æ¨¡å—vue3.0çš„ç”¨æ³•ï¼Œå¸¦å‘½åç©ºé—´æ¨¡å—å†vue3.0çš„ç”¨æ³•

1. æ ¹æ¨¡å—çš„ç”¨æ³•

å®šä¹‰

```js
// vue2.0 åˆ›å»ºä»“åº“ new Vuex.Store({})
// vue3.0 åˆ›å»ºä»“åº“ createStore({})
export default createStore({
  state: {
    username: 'zs'
  },
  getters: {
    newName (state) {
      return state.username + '!!!'
    }
  },
  mutations: {
    updateName (state) {
      state.username = 'ls'
    }
  },
  actions: {
    updateName (ctx) {
      // å‘è¯·æ±‚
      setTimeout(() => {
        ctx.commit('updateName')
      }, 1000)
    }
  },
  modules: {

  }
})
```

ä½¿ç”¨

```js
<template>
  <!-- vue2.0éœ€è¦æ ¹å…ƒç´ ï¼Œvue3.0å¯ä»¥æ˜¯ä»£ç ç‰‡æ®µ Fragment -->
  <div>
    App
    <!-- 1. ä½¿ç”¨æ ¹æ¨¡å—stateçš„æ•°æ®   -->
    <p>{{$store.state.username}}</p>
    <!-- 2. ä½¿ç”¨æ ¹æ¨¡å—gettersçš„æ•°æ®   -->
    <p>{{$store.getters['newName']}}</p>
    <button @click="mutationsFn">mutationsFn</button>
  </div>
</template>
<script>
import { useStore } from 'vuex'
export default {
  name: 'App',
  setup () {
    // ä½¿ç”¨vuexä»“åº“
    const store = useStore()
    // 1. ä½¿ç”¨æ ¹æ¨¡å—stateçš„æ•°æ®
    console.log(store.state.username)
    // 2. ä½¿ç”¨æ ¹æ¨¡å—gettersçš„æ•°æ®
    console.log(store.getters.newName)
    const mutationsFn = () => {
      // 3. æäº¤æ ¹æ¨¡å—mutationså‡½æ•°
      // store.commit('updateName')
      // 4. è°ƒç”¨æ ¹æ¨¡å—actionså‡½æ•°
      store.dispatch('updateName')
    }
    return { mutationsFn }
  }
}
</script>
```



2. modules (åˆ†æ¨¡å—)

- å­˜åœ¨ä¸¤ç§æƒ…å†µ
  - é»˜è®¤çš„æ¨¡å—ï¼Œ`state` åŒºåˆ†æ¨¡å—ï¼Œå…¶ä»– `getters` `mutations` `actions` éƒ½åœ¨å…¨å±€ã€‚
  - å¸¦å‘½åç©ºé—´ `namespaced: true` çš„æ¨¡å—ï¼Œæ‰€æœ‰åŠŸèƒ½åŒºåˆ†æ¨¡å—ï¼Œæ›´é«˜å°è£…åº¦å’Œå¤ç”¨ã€‚

```js
import { createStore } from 'vuex'

const moduleA = {
  // å­æ¨¡å—stateå»ºè®®å†™æˆå‡½æ•°
  state: () => {
    return {
      username: 'æ¨¡å—A'
    }
  },
  getters: {
    changeName (state) {
      return state.username + 'AAAAAA'
    }
  }
}

const moduleB = {
  // å¸¦å‘½åç©ºé—´çš„æ¨¡å—
  namespaced: true,
  // å­æ¨¡å—stateå»ºè®®å†™æˆå‡½æ•°
  state: () => {
    return {
      username: 'æ¨¡å—B'
    }
  },
  getters: {
    changeName (state) {
      return state.username + 'BBBBBB'
    }
  },
  mutations: {
    // ä¿®æ”¹åå­—çš„mutation
    update (state) {
      state.username = 'BBBB' + state.username
    }
  },
  actions: {
    update ({ commit }) {
      // å‡è®¾è¯·æ±‚
      setTimeout(() => {
        commit('update')
      }, 2000)
    }
  }
}

// åˆ›å»ºvuexä»“åº“å¹¶å¯¼å‡º
export default createStore({
  state: {
    // æ•°æ®
    person: [
      { id: 1, name: 'tom', gender: 'ç”·' },
      { id: 2, name: 'lucy', gender: 'å¥³' },
      { id: 3, name: 'jack', gender: 'ç”·' }
    ]
  },
  mutations: {
    // æ”¹æ•°æ®å‡½æ•°
  },
  actions: {
    // è¯·æ±‚æ•°æ®å‡½æ•°
  },
  modules: {
    // åˆ†æ¨¡å—
    a: moduleA,
    b: moduleB
  },
  getters: {
    // vuexçš„è®¡ç®—å±æ€§
    boys: (state) => {
      return state.person.filter(p => p.gender === 'ç”·')
    }
  }
})

```

ä½¿ç”¨ï¼š

```vue
<template>
 <div>APPç»„ä»¶</div>
 <ul>
   <li v-for="item in $store.getters.boys" :key="item.id">{{item.name}}</li>
 </ul>
 <!-- ä½¿ç”¨æ¨¡å—Açš„username -->
 <p>Açš„username --- {{$store.state.a.username}}</p>
 <p>Açš„changeName --- {{$store.getters.changeName}}</p>
 <hr>
 <p>Bçš„username --- {{$store.state.b.username}}</p>
 <p>Bçš„changeName --- {{$store.getters['b/changeName']}}</p>
 <button @click="$store.commit('b/update')">ä¿®æ”¹username</button>
 <button @click="$store.dispatch('b/update')">å¼‚æ­¥ä¿®æ”¹username</button>
</template>
```



## 04-vuex-æŒä¹…åŒ–

> ç›®çš„ï¼šè®©åœ¨vuexä¸­ç®¡ç†çš„çŠ¶æ€æ•°æ®åŒæ—¶å­˜å‚¨åœ¨æœ¬åœ°ã€‚å¯å…å»è‡ªå·±å­˜å‚¨çš„ç¯èŠ‚ã€‚

- åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œåƒç”¨æˆ·ä¿¡æ¯ï¼ˆåå­—ï¼Œå¤´åƒï¼Œtokenï¼‰éœ€è¦vuexä¸­å­˜å‚¨ä¸”éœ€è¦æœ¬åœ°å­˜å‚¨ã€‚
- å†ä¾‹å¦‚ï¼Œè´­ç‰©è½¦å¦‚æœéœ€è¦æœªç™»å½•çŠ¶æ€ä¸‹ä¹Ÿæ”¯æŒï¼Œå¦‚æœç®¡ç†åœ¨vuexä¸­é¡µéœ€è¦å­˜å‚¨åœ¨æœ¬åœ°ã€‚
- æˆ‘ä»¬éœ€è¦categoryæ¨¡å—å­˜å‚¨åˆ†ç±»ä¿¡æ¯ï¼Œä½†æ˜¯åˆ†ç±»ä¿¡æ¯ä¸éœ€è¦æŒä¹…åŒ–ã€‚

1ï¼‰é¦–å…ˆï¼šæˆ‘ä»¬éœ€è¦å®‰è£…ä¸€ä¸ªvuexçš„æ’ä»¶`vuex-persistedstate`æ¥æ”¯æŒvuexçš„çŠ¶æ€æŒä¹…åŒ–ã€‚

```bash
npm i vuex-persistedstate
```

2ï¼‰ç„¶åï¼šåœ¨`src/store` æ–‡ä»¶å¤¹ä¸‹æ–°å»º `modules` æ–‡ä»¶ï¼Œåœ¨ `modules` ä¸‹æ–°å»º `user.js` å’Œ `cart.js`

`src/store/modules/user.js`

```js
// ç”¨æˆ·æ¨¡å—
export default {
  namespaced: true,
  state () {
    return {
      // ç”¨æˆ·ä¿¡æ¯
      profile: {
        id: '',
        avatar: '',
        nickname: '',
        account: '',
        mobile: '',
        token: ''
      }
    }
  },
  mutations: {
    // ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼Œpayloadå°±æ˜¯ç”¨æˆ·ä¿¡æ¯å¯¹è±¡
    setUser (state, payload) {
      state.profile = payload
    }
  }
}

```



`src/store/modules/cart.js`

```js
// è´­ç‰©è½¦çŠ¶æ€
export default {
  namespaced: true,
  state: () => {
    return {
      list: []
    }
  }
}
```



`src/store/modules/category.js`

```js
// åˆ†ç±»æ¨¡å—
export default {
  namespaced: true,
  state () {
    return {
      // åˆ†ç±»ä¿¡æ¯é›†åˆ
      list: []
    }
  }
}
```



3ï¼‰ç»§ç»­ï¼šåœ¨ `src/store/index.js` ä¸­å¯¼å…¥ user cart æ¨¡å—ã€‚

```js
import { createStore } from 'vuex'

import user from './modules/user'
import cart from './modules/cart'
import cart from './modules/category'

export default createStore({
  modules: {
    user,
    cart,
    category
  }
})
```



4ï¼‰æœ€åï¼šä½¿ç”¨vuex-persistedstateæ’ä»¶æ¥è¿›è¡ŒæŒä¹…åŒ– `store/index`

```diff
import { createStore } from 'vuex'
+import createPersistedstate from 'vuex-persistedstate'

import user from './modules/user'
import cart from './modules/cart'
import cart from './modules/category'

export default createStore({
  modules: {
    user,
    cart,
    category
  },
+  plugins: [
+    createPersistedstate({
+      key: 'erabbit-client-pc-store',
+      paths: ['user', 'cart']
+    })
+  ]
})
```

**æ³¨æ„ï¼š**

===> é»˜è®¤æ˜¯å­˜å‚¨åœ¨localStorageä¸­

===> keyæ˜¯å­˜å‚¨æ•°æ®çš„é”®å

===> pathsæ˜¯å­˜å‚¨stateä¸­çš„é‚£äº›æ•°æ®ï¼Œå¦‚æœæ˜¯æ¨¡å—ä¸‹å…·ä½“çš„æ•°æ®éœ€è¦åŠ ä¸Šæ¨¡å—åç§°ï¼Œå¦‚`user.token`

===> ä¿®æ”¹stateåè§¦å‘æ‰å¯ä»¥çœ‹åˆ°æœ¬åœ°å­˜å‚¨æ•°æ®çš„çš„å˜åŒ–ã€‚

**æµ‹è¯•ï¼š** useræ¨¡å—å®šä¹‰ä¸€ä¸ªmutationåœ¨main.jså»è°ƒç”¨ä¸‹ï¼Œè§‚å¯Ÿæµè§ˆå™¨applicationçš„localStorageä¸‹æ•°æ®ã€‚

`src/App.vue`

```js
<template>
  <div class="container">
    <!-- ä¿®æ”¹æ•°æ®ï¼Œæµ‹è¯•æ˜¯å¦æŒä¹…åŒ– -->
    App {{$store.state.user.profile.account}}
    <button @click="$store.commit('user/setUser',{account:'zhousg'})">è®¾ç½®ç”¨æˆ·ä¿¡æ¯</button>
  </div>
</template>
<script>
export default {
  name: 'App'
}
</script>
```



## 05-è¯·æ±‚å·¥å…·

>  ç›®çš„ï¼šåŸºäºaxioså°è£…ä¸€ä¸ªè¯·æ±‚å·¥å…·ï¼Œè°ƒç”¨æ¥å£æ—¶ä½¿ç”¨ã€‚

- å®‰è£… axios

```js
npm i axios
```

- æ–°å»º `src/utils/request.js` æ¨¡å—ï¼Œä»£ç å¦‚ä¸‹

```js
// 1. åˆ›å»ºä¸€ä¸ªæ–°çš„axioså®ä¾‹
// 2. è¯·æ±‚æ‹¦æˆªå™¨ï¼Œå¦‚æœæœ‰tokenè¿›è¡Œå¤´éƒ¨æºå¸¦
// 3. å“åº”æ‹¦æˆªå™¨ï¼š1. å‰¥ç¦»æ— æ•ˆæ•°æ®  2. å¤„ç†tokenå¤±æ•ˆ
// 4. å¯¼å‡ºä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨å½“å‰çš„axsioå®ä¾‹å‘è¯·æ±‚ï¼Œè¿”å›å€¼promise

import axios from 'axios'
import store from '@/store'
import router from '@/router'

// å¯¼å‡ºåŸºå‡†åœ°å€ï¼ŒåŸå› ï¼šå…¶ä»–åœ°æ–¹ä¸æ˜¯é€šè¿‡axioså‘è¯·æ±‚çš„åœ°æ–¹ç”¨ä¸ŠåŸºå‡†åœ°å€
export const baseURL = 'http://pcapi-xiaotuxian-front-devtest.itheima.net/'
const instance = axios.create({
  // axios çš„ä¸€äº›é…ç½®ï¼ŒbaseURL  timeout
  baseURL,
  timeout: 5000
})

instance.interceptors.request.use(config => {
  // æ‹¦æˆªä¸šåŠ¡é€»è¾‘
  // è¿›è¡Œè¯·æ±‚é…ç½®çš„ä¿®æ”¹
  // å¦‚æœæœ¬åœ°åˆtokenå°±åœ¨å¤´éƒ¨æºå¸¦
  // 1. è·å–ç”¨æˆ·ä¿¡æ¯å¯¹è±¡
  const { profile } = store.state.user
  // 2. åˆ¤æ–­æ˜¯å¦æœ‰token
  if (profile.token) {
    // 3. è®¾ç½®token
    config.headers.Authorization = `Bearer ${profile.token}`
  }
  return config
}, err => {
  return Promise.reject(err)
})

// res => res.data  å–å‡ºdataæ•°æ®ï¼Œå°†æ¥è°ƒç”¨æ¥å£çš„æ—¶å€™ç›´æ¥æ‹¿åˆ°çš„å°±æ˜¯åå°çš„æ•°æ®
instance.interceptors.response.use(res => res.data, err => {
  // 401 çŠ¶æ€ç ï¼Œè¿›å…¥è¯¥å‡½æ•°
  if (err.response && err.response.status === 401) {
    // 1. æ¸…ç©ºæ— æ•ˆç”¨æˆ·ä¿¡æ¯
    // 2. è·³è½¬åˆ°ç™»å½•é¡µ
    // 3. è·³è½¬éœ€è¦ä¼ å‚ï¼ˆå½“å‰è·¯ç”±åœ°å€ï¼‰ç»™ç™»å½•é¡µç 
    store.commit('user/setUser', {})
    // å½“å‰è·¯ç”±åœ°å€
    // ç»„ä»¶é‡Œå¤´ï¼š`/user?a=10` $route.path === /user  $route.fullPath === /user?a=10
    // jsæ¨¡å—ä¸­ï¼šrouter.currentRoute.value.fullPath å°±æ˜¯å½“å‰è·¯ç”±åœ°å€ï¼Œrouter.currentRoute æ˜¯refå“åº”å¼æ•°æ®
    const fullPath = encodeURIComponent(router.currentRoute.value.fullPath)
    // encodeURIComponent è½¬æ¢uriç¼–ç ï¼Œé˜²æ­¢è§£æåœ°å€å‡ºé—®é¢˜
    router.push('/login?redirectUrl=' + fullPath)
  }
  return Promise.reject(err)
})

// è¯·æ±‚å·¥å…·å‡½æ•°
export default (url, method, submitData) => {
  // è´Ÿè´£å‘è¯·æ±‚ï¼šè¯·æ±‚åœ°å€ï¼Œè¯·æ±‚æ–¹å¼ï¼Œæäº¤çš„æ•°æ®
  return instance({
    url,
    method,
    // 1. å¦‚æœæ˜¯getè¯·æ±‚  éœ€è¦ä½¿ç”¨paramsæ¥ä¼ é€’submitData   ?a=10&c=10
    // 2. å¦‚æœä¸æ˜¯getè¯·æ±‚  éœ€è¦ä½¿ç”¨dataæ¥ä¼ é€’submitData   è¯·æ±‚ä½“ä¼ å‚
    // [] è®¾ç½®ä¸€ä¸ªåŠ¨æ€çš„key, å†™jsè¡¨è¾¾å¼ï¼Œjsè¡¨è¾¾å¼çš„æ‰§è¡Œç»“æœå½“ä½œKEY
    // methodå‚æ•°ï¼šget,Get,GET  è½¬æ¢æˆå°å†™å†æ¥åˆ¤æ–­
    // åœ¨å¯¹è±¡ï¼Œ['params']:submitData ===== params:submitData è¿™æ ·ç†è§£
    [method.toLowerCase() === 'get' ? 'params' : 'data']: submitData
  })
}
```



## 06-è·¯ç”±è®¾è®¡

> ç›®çš„ï¼šçŸ¥é“é¡¹ç›®è·¯ç”±å±‚çº§çš„è®¾è®¡

![image-20211208145748131](https://gitee.com/toprhythm/imagebed/raw/master/picgoimagebebrepo/image-20211208145748131.png)

| è·¯å¾„               | ç»„ä»¶ï¼ˆåŠŸèƒ½ï¼‰     | åµŒå¥—çº§åˆ« |
| ------------------ | ---------------- | -------- |
| /                  | é¦–é¡µå¸ƒå±€å®¹å™¨     | 1çº§      |
| /                  | é¦–é¡µ             | 2çº§      |
| /category/:id      | ä¸€çº§åˆ†ç±»         | 2çº§      |
| /category/sub/:id  | äºŒçº§åˆ†ç±»         | 2çº§      |
| /product/:id       | å•†å“è¯¦æƒ…         | 2çº§      |
| /login             | ç™»å½•             | 1çº§      |
| /login/callback    | ç¬¬ä¸‰æ–¹ç™»å½•å›è°ƒ   | 1çº§      |
| /cart              | è´­ç‰©è½¦           | 2çº§      |
| /member/checkout   | å¡«å†™è®¢å•         | 2çº§      |
| /member/pay        | è¿›è¡Œæ”¯ä»˜         | 2çº§      |
| /member/pay/result | æ”¯ä»˜ç»“æœ         | 2çº§      |
| /member            | ä¸ªäººä¸­å¿ƒå¸ƒå±€å®¹å™¨ | 2çº§      |
| /member            | ä¸ªäººä¸­å¿ƒ         | 3çº§      |
| /member/order      | è®¢å•ç®¡ç†         | 3çº§      |
| /member/order/:id  | è®¢å•è¯¦æƒ…         | 3çº§      |



